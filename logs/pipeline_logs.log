2024-06-22 21:59:41,609 [INFO] __main__: Pipeline started at 2024-06-22 21:59:41.609472
2024-06-22 21:59:41,609 [INFO] __main__: Fetching exchange data from CoinGecko API
2024-06-22 21:59:41,609 [INFO] etl_process.extract: Starting to fetch data from https://api.coingecko.com/api/v3/exchanges with headers: {'accept': 'application/json', 'x-cg-pro-api-key': 'CG-e2wRRAdihEkAP6M4sLxu73N3'}
2024-06-22 21:59:41,612 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-22 21:59:42,408 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=1 HTTP/11" 200 None
2024-06-22 21:59:42,412 [INFO] etl_process.extract: API request returned status: 200
2024-06-22 21:59:42,415 [INFO] etl_process.extract: Fetched 100 records from page 1
2024-06-22 21:59:42,415 [INFO] etl_process.extract: Proceeding to the next page: 2
2024-06-22 21:59:43,418 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-22 21:59:43,898 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=2 HTTP/11" 400 None
2024-06-22 21:59:43,899 [ERROR] etl_process.extract: HTTP error occurred: 400 Client Error: Bad Request for url: https://api.coingecko.com/api/v3/exchanges?per_page=100&page=2
2024-06-22 21:59:43,900 [INFO] __main__: Fetched exchange data: 100 records
2024-06-22 21:59:43,901 [INFO] __main__: Transforming exchange data
2024-06-22 21:59:43,901 [INFO] etl_process.transform: Data fetched successfully from API.
2024-06-22 21:59:43,903 [INFO] __main__: Transformed complete, table: 100 rows
2024-06-22 21:59:43,903 [INFO] __main__: Converting BTC to USD and performing additional transformations
2024-06-22 21:59:43,903 [INFO] etl_process.extract: Fetching BTC to USD rate from CoinCap API
2024-06-22 21:59:43,904 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coincap.io:443
2024-06-22 21:59:44,441 [DEBUG] urllib3.connectionpool: https://api.coincap.io:443 "GET /v2/rates/bitcoin HTTP/11" 200 None
2024-06-22 21:59:44,441 [INFO] etl_process.extract: Successfully fetched BTC to USD rate: 64336.47
2024-06-22 21:59:44,450 [INFO] __main__: Data transformation complete.
2024-06-22 21:59:44,450 [INFO] __main__:  100 rows & 15 columns.
2024-06-22 21:59:44,450 [INFO] __main__: Loading data into data warehouse
2024-06-22 21:59:44,451 [INFO] etl_process.load: Starting to write DataFrame to MotherDuck
2024-06-22 22:02:10,777 [DEBUG] etl_process.load: Executing SQL insert/update command
2024-06-22 22:02:11,709 [INFO] __main__: Data successfully loaded into MotherDuck
2024-06-22 22:02:11,710 [INFO] __main__: Pipeline completed successfully at 2024-06-22 22:02:11.709972.Total time: 0:02:30.100500
