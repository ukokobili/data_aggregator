2024-06-21 13:36:42,101 [INFO] __main__: Pipeline started at 2024-06-21 13:36:42.101402
2024-06-21 13:36:42,101 [INFO] __main__: Fetching exchange data from CoinGecko API
2024-06-21 13:36:42,101 [INFO] etl_process.extract: Starting to fetch data from https://api.coingecko.com/api/v3/exchanges with headers: {'accept': 'application/json', 'x-cg-pro-api-key': 'CG-e2wRRAdihEkAP6M4sLxu73N3'}
2024-06-21 13:36:42,104 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 13:36:42,697 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=1 HTTP/11" 200 None
2024-06-21 13:36:42,703 [INFO] etl_process.extract: API request returned status: 200
2024-06-21 13:36:42,705 [INFO] etl_process.extract: Fetched 100 records from page 1
2024-06-21 13:36:42,705 [INFO] etl_process.extract: Proceeding to the next page: 2
2024-06-21 13:36:43,709 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 13:36:44,276 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=2 HTTP/11" 400 None
2024-06-21 13:36:44,278 [ERROR] etl_process.extract: HTTP error occurred: 400 Client Error: Bad Request for url: https://api.coingecko.com/api/v3/exchanges?per_page=100&page=2
2024-06-21 13:36:44,279 [INFO] __main__: Fetched exchange data: 100 records
2024-06-21 13:36:44,279 [INFO] __main__: Transforming exchange data
2024-06-21 13:36:44,280 [INFO] etl_process.transform: Data fetched successfully from API.
2024-06-21 13:36:44,287 [INFO] __main__: Transformed complete, table: 100 rows
2024-06-21 13:36:44,288 [INFO] __main__: Converting BTC to USD and performing additional transformations
2024-06-21 13:36:44,290 [INFO] etl_process.extract: Fetching BTC to USD rate from CoinCap API
2024-06-21 13:36:44,292 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coincap.io:443
2024-06-21 13:36:44,978 [DEBUG] urllib3.connectionpool: https://api.coincap.io:443 "GET /v2/rates/bitcoin HTTP/11" 200 None
2024-06-21 13:36:44,979 [INFO] etl_process.extract: Successfully fetched BTC to USD rate: 63770.19
2024-06-21 13:36:44,996 [INFO] __main__: Data transformation complete.
2024-06-21 13:36:44,996 [INFO] __main__:  100 rows & 15 columns.
2024-06-21 13:36:44,996 [INFO] __main__: Loading data into data warehouse
2024-06-21 13:36:44,997 [INFO] etl_process.load: Starting to write DataFrame to MotherDuck
2024-06-21 13:36:48,329 [DEBUG] etl_process.load: Executing SQL insert/update command
2024-06-21 13:36:49,335 [INFO] __main__: Data successfully loaded into MotherDuck
2024-06-21 13:36:49,336 [INFO] __main__: Pipeline completed successfully at 2024-06-21 13:36:49.335943.Total time: 0:00:07.234541
