2024-06-23 23:04:43,150 [INFO] root: API key successfully retrieved.
2024-06-23 23:04:43,151 [INFO] __main__: Pipeline started at 2024-06-23 23:04:43.151071
2024-06-23 23:04:43,151 [INFO] __main__: Fetching exchange data from CoinGecko API
2024-06-23 23:04:43,151 [INFO] etl_process.extract: Starting to fetch data from https://api.coingecko.com/api/v3/exchanges with headers: {'accept': 'application/json', 'x-cg-demo-api-key': 'CG-e2wRRAdihEkAP6M4sLxu73N3'}
2024-06-23 23:04:43,154 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-23 23:04:43,630 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=1 HTTP/11" 200 None
2024-06-23 23:04:43,632 [INFO] etl_process.extract: API request returned status: 200
2024-06-23 23:04:43,633 [INFO] etl_process.extract: Fetched 100 records from page 1
2024-06-23 23:04:43,633 [INFO] etl_process.extract: Proceeding to the next page: 2
2024-06-23 23:04:44,636 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-23 23:04:45,207 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=2 HTTP/11" 200 None
2024-06-23 23:04:45,209 [INFO] etl_process.extract: API request returned status: 200
2024-06-23 23:04:45,210 [INFO] etl_process.extract: Fetched 100 records from page 2
2024-06-23 23:04:45,211 [INFO] etl_process.extract: Proceeding to the next page: 3
2024-06-23 23:04:46,214 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-23 23:04:46,797 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=3 HTTP/11" 200 None
2024-06-23 23:04:46,800 [INFO] etl_process.extract: API request returned status: 200
2024-06-23 23:04:46,801 [INFO] etl_process.extract: Fetched 100 records from page 3
2024-06-23 23:04:46,802 [INFO] etl_process.extract: Proceeding to the next page: 4
2024-06-23 23:04:47,804 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-23 23:04:48,371 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=4 HTTP/11" 200 None
2024-06-23 23:04:48,374 [INFO] etl_process.extract: API request returned status: 200
2024-06-23 23:04:48,375 [INFO] etl_process.extract: Fetched 100 records from page 4
2024-06-23 23:04:48,375 [INFO] etl_process.extract: Proceeding to the next page: 5
2024-06-23 23:04:49,378 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-23 23:04:49,935 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=5 HTTP/11" 200 None
2024-06-23 23:04:49,939 [INFO] etl_process.extract: API request returned status: 200
2024-06-23 23:04:49,940 [INFO] etl_process.extract: Fetched 100 records from page 5
2024-06-23 23:04:49,940 [INFO] etl_process.extract: Proceeding to the next page: 6
2024-06-23 23:04:50,943 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-23 23:04:51,647 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=6 HTTP/11" 200 None
2024-06-23 23:04:51,855 [INFO] etl_process.extract: API request returned status: 200
2024-06-23 23:04:51,857 [INFO] etl_process.extract: Fetched 100 records from page 6
2024-06-23 23:04:51,857 [INFO] etl_process.extract: Proceeding to the next page: 7
2024-06-23 23:04:52,860 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-23 23:04:53,843 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=7 HTTP/11" 200 None
2024-06-23 23:04:53,846 [INFO] etl_process.extract: API request returned status: 200
2024-06-23 23:04:53,848 [INFO] etl_process.extract: Fetched 100 records from page 7
2024-06-23 23:04:53,848 [INFO] etl_process.extract: Proceeding to the next page: 8
2024-06-23 23:04:54,852 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-23 23:04:55,755 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=8 HTTP/11" 200 None
2024-06-23 23:04:55,776 [INFO] etl_process.extract: API request returned status: 200
2024-06-23 23:04:55,777 [INFO] etl_process.extract: Fetched 100 records from page 8
2024-06-23 23:04:55,778 [INFO] etl_process.extract: Proceeding to the next page: 9
2024-06-23 23:04:56,781 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-23 23:04:58,003 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=9 HTTP/11" 200 None
2024-06-23 23:04:58,005 [INFO] etl_process.extract: API request returned status: 200
2024-06-23 23:04:58,006 [INFO] etl_process.extract: Fetched 82 records from page 9
2024-06-23 23:04:58,007 [INFO] etl_process.extract: No more data to fetch. Exiting loop.
2024-06-23 23:04:58,017 [INFO] __main__: Fetched exchange data: 882 records
2024-06-23 23:04:58,017 [INFO] __main__: Transforming exchange data
2024-06-23 23:04:58,018 [INFO] etl_process.transform: Data fetched successfully from API.
2024-06-23 23:04:58,036 [INFO] __main__: Transformed complete, table: 882 rows
2024-06-23 23:04:58,037 [INFO] __main__: Converting BTC to USD and performing additional transformations
2024-06-23 23:04:58,037 [INFO] etl_process.extract: Fetching BTC to USD rate from CoinCap API
2024-06-23 23:04:58,049 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coincap.io:443
2024-06-23 23:04:58,817 [DEBUG] urllib3.connectionpool: https://api.coincap.io:443 "GET /v2/rates/bitcoin HTTP/11" 200 None
2024-06-23 23:04:58,818 [INFO] etl_process.extract: Successfully fetched BTC to USD rate: 63692.48
2024-06-23 23:04:58,866 [INFO] __main__: Data transformation complete.
2024-06-23 23:04:58,867 [INFO] __main__:  882 rows & 15 columns.
2024-06-23 23:04:58,867 [INFO] __main__: Loading data into data warehouse
2024-06-23 23:04:58,867 [INFO] etl_process.load: Starting to write DataFrame to MotherDuck
2024-06-23 23:06:08,917 [DEBUG] etl_process.load: Executing SQL insert/update command
2024-06-23 23:06:10,316 [INFO] __main__: Data successfully loaded into MotherDuck
2024-06-23 23:06:10,316 [INFO] __main__: Pipeline completed successfully at 2024-06-23 23:06:10.316759.Total time: 0:01:27.165688
