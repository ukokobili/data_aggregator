2024-06-21 08:11:38,102 [INFO] numexpr.utils: NumExpr defaulting to 4 threads.
2024-06-21 08:11:40,016 [INFO] etl_process.extract: Fetching BTC to USD rate from CoinCap API
2024-06-21 08:11:40,020 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coincap.io:443
2024-06-21 08:11:40,831 [DEBUG] urllib3.connectionpool: https://api.coincap.io:443 "GET /v2/rates/bitcoin HTTP/1.1" 200 None
2024-06-21 08:11:40,834 [INFO] etl_process.extract: Successfully fetched BTC to USD rate: 64638.57
2024-06-21 08:13:34,400 [INFO] numexpr.utils: NumExpr defaulting to 4 threads.
2024-06-21 08:13:34,895 [INFO] etl_process.extract: Fetching BTC to USD rate from CoinCap API
2024-06-21 08:13:34,898 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coincap.io:443
2024-06-21 08:13:35,313 [DEBUG] urllib3.connectionpool: https://api.coincap.io:443 "GET /v2/rates/bitcoin HTTP/1.1" 200 None
2024-06-21 08:13:35,314 [INFO] etl_process.extract: Successfully fetched BTC to USD rate: 64657.2
2024-06-21 08:17:47,822 [INFO] numexpr.utils: NumExpr defaulting to 4 threads.
2024-06-21 08:17:48,496 [INFO] etl_process.extract: Fetching BTC to USD rate from CoinCap API
2024-06-21 08:17:48,499 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coincap.io:443
2024-06-21 08:17:49,127 [DEBUG] urllib3.connectionpool: https://api.coincap.io:443 "GET /v2/rates/bitcoin HTTP/1.1" 200 None
2024-06-21 08:17:49,128 [INFO] etl_process.extract: Successfully fetched BTC to USD rate: 64711.59
2024-06-21 08:17:49,145 [INFO] data_pipeline: Pipeline started at 2024-06-21 08:17:49.145450
2024-06-21 08:17:49,145 [INFO] data_pipeline: Fetching exchange data from CoinGecko API
2024-06-21 08:17:49,146 [INFO] data_pipeline: Fetched exchange data: 4 records
2024-06-21 08:17:49,146 [INFO] data_pipeline: Transforming exchange data
2024-06-21 08:17:49,146 [INFO] data_pipeline: Transformed complete, table: 1 rows
2024-06-21 08:17:49,146 [INFO] data_pipeline: Converting BTC to USD and performing additional transformations
2024-06-21 08:17:49,146 [INFO] data_pipeline: Data transformation complete.
2024-06-21 08:17:49,146 [INFO] data_pipeline:  1 rows & 10 columns.
2024-06-21 08:17:49,147 [INFO] data_pipeline: Loading data into data warehouse
2024-06-21 08:17:49,147 [INFO] data_pipeline: Data successfully loaded into MotherDuck
2024-06-21 08:17:49,148 [INFO] data_pipeline: Pipeline completed successfully at 2024-06-21 08:17:49.148003.Total time: 0:00:00.002553
2024-06-21 08:20:00,910 [INFO] numexpr.utils: NumExpr defaulting to 4 threads.
2024-06-21 08:20:01,402 [INFO] etl_process.extract: Fetching BTC to USD rate from CoinCap API
2024-06-21 08:20:01,404 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coincap.io:443
2024-06-21 08:20:01,983 [DEBUG] urllib3.connectionpool: https://api.coincap.io:443 "GET /v2/rates/bitcoin HTTP/1.1" 200 None
2024-06-21 08:20:01,984 [INFO] etl_process.extract: Successfully fetched BTC to USD rate: 64710.48
2024-06-21 08:20:28,066 [INFO] numexpr.utils: NumExpr defaulting to 4 threads.
2024-06-21 08:20:29,043 [INFO] etl_process.extract: Fetching BTC to USD rate from CoinCap API
2024-06-21 08:20:29,047 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coincap.io:443
2024-06-21 08:20:29,367 [DEBUG] urllib3.connectionpool: https://api.coincap.io:443 "GET /v2/rates/bitcoin HTTP/1.1" 200 None
2024-06-21 08:20:29,369 [INFO] etl_process.extract: Successfully fetched BTC to USD rate: 64711.24
2024-06-21 08:20:29,384 [INFO] data_pipeline: Pipeline started at 2024-06-21 08:20:29.384275
2024-06-21 08:20:29,384 [INFO] data_pipeline: Fetching exchange data from CoinGecko API
2024-06-21 08:20:29,384 [INFO] data_pipeline: Fetched exchange data: 4 records
2024-06-21 08:20:29,384 [INFO] data_pipeline: Transforming exchange data
2024-06-21 08:20:29,385 [INFO] data_pipeline: Transformed complete, table: 1 rows
2024-06-21 08:20:29,385 [INFO] data_pipeline: Converting BTC to USD and performing additional transformations
2024-06-21 08:20:29,390 [INFO] data_pipeline: Data transformation complete.
2024-06-21 08:20:29,390 [INFO] data_pipeline:  1 rows & 10 columns.
2024-06-21 08:20:29,390 [INFO] data_pipeline: Loading data into data warehouse
2024-06-21 08:20:29,391 [INFO] data_pipeline: Data successfully loaded into MotherDuck
2024-06-21 08:20:29,391 [INFO] data_pipeline: Pipeline completed successfully at 2024-06-21 08:20:29.391565.Total time: 0:00:00.007290
2024-06-21 08:26:16,945 [INFO] numexpr.utils: NumExpr defaulting to 4 threads.
2024-06-21 08:26:17,438 [INFO] data_pipeline: Pipeline started at 2024-06-21 08:26:17.438777
2024-06-21 08:26:17,439 [INFO] data_pipeline: Fetching exchange data from CoinGecko API
2024-06-21 08:26:17,439 [INFO] etl_process.extract: Starting to fetch data from https://api.coingecko.com/api/v3/exchanges with headers: {'accept': 'application/json', 'x-cg-pro-api-key': None}
2024-06-21 08:26:17,443 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:26:18,712 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=1 HTTP/1.1" 200 None
2024-06-21 08:26:18,746 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=1 returned status: 200
2024-06-21 08:26:18,747 [INFO] etl_process.extract: Fetched 100 records from page 1
2024-06-21 08:26:18,747 [INFO] etl_process.extract: Proceeding to the next page: 2
2024-06-21 08:26:19,749 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:26:20,484 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=2 HTTP/1.1" 200 None
2024-06-21 08:26:20,488 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=2 returned status: 200
2024-06-21 08:26:20,490 [INFO] etl_process.extract: Fetched 100 records from page 2
2024-06-21 08:26:20,490 [INFO] etl_process.extract: Proceeding to the next page: 3
2024-06-21 08:26:21,492 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:26:22,095 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=3 HTTP/1.1" 200 None
2024-06-21 08:26:22,098 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=3 returned status: 200
2024-06-21 08:26:22,099 [INFO] etl_process.extract: Fetched 100 records from page 3
2024-06-21 08:26:22,100 [INFO] etl_process.extract: Proceeding to the next page: 4
2024-06-21 08:26:23,102 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:26:23,875 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=4 HTTP/1.1" 200 None
2024-06-21 08:26:23,880 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=4 returned status: 200
2024-06-21 08:26:23,881 [INFO] etl_process.extract: Fetched 100 records from page 4
2024-06-21 08:26:23,881 [INFO] etl_process.extract: Proceeding to the next page: 5
2024-06-21 08:26:24,885 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:26:25,660 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=5 HTTP/1.1" 200 None
2024-06-21 08:26:25,664 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=5 returned status: 200
2024-06-21 08:26:25,666 [INFO] etl_process.extract: Fetched 100 records from page 5
2024-06-21 08:26:25,666 [INFO] etl_process.extract: Proceeding to the next page: 6
2024-06-21 08:26:26,669 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:26:27,932 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=6 HTTP/1.1" 200 None
2024-06-21 08:26:27,935 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=6 returned status: 200
2024-06-21 08:26:27,938 [INFO] etl_process.extract: Fetched 100 records from page 6
2024-06-21 08:26:27,938 [INFO] etl_process.extract: Proceeding to the next page: 7
2024-06-21 08:26:28,940 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:26:29,610 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=7 HTTP/1.1" 200 None
2024-06-21 08:26:29,614 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=7 returned status: 200
2024-06-21 08:26:29,624 [INFO] etl_process.extract: Fetched 100 records from page 7
2024-06-21 08:26:29,624 [INFO] etl_process.extract: Proceeding to the next page: 8
2024-06-21 08:26:30,626 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:26:31,622 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=8 HTTP/1.1" 200 None
2024-06-21 08:26:31,626 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=8 returned status: 200
2024-06-21 08:26:31,628 [INFO] etl_process.extract: Fetched 100 records from page 8
2024-06-21 08:26:31,628 [INFO] etl_process.extract: Proceeding to the next page: 9
2024-06-21 08:26:32,630 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:26:33,220 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=9 HTTP/1.1" 200 None
2024-06-21 08:26:33,224 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=9 returned status: 200
2024-06-21 08:26:33,225 [INFO] etl_process.extract: Fetched 72 records from page 9
2024-06-21 08:26:33,226 [INFO] etl_process.extract: No more data to fetch. Exiting loop.
2024-06-21 08:26:33,237 [INFO] data_pipeline: Fetched exchange data: 872 records
2024-06-21 08:26:33,239 [INFO] data_pipeline: Transforming exchange data
2024-06-21 08:26:33,239 [INFO] etl_process.transform: Data fetched successfully from API.
2024-06-21 08:26:33,259 [INFO] data_pipeline: Transformed complete, table: 872 rows
2024-06-21 08:26:33,259 [INFO] data_pipeline: Converting BTC to USD and performing additional transformations
2024-06-21 08:26:33,259 [INFO] etl_process.extract: Fetching BTC to USD rate from CoinCap API
2024-06-21 08:26:33,263 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coincap.io:443
2024-06-21 08:26:34,044 [DEBUG] urllib3.connectionpool: https://api.coincap.io:443 "GET /v2/rates/bitcoin HTTP/1.1" 200 None
2024-06-21 08:26:34,046 [INFO] etl_process.extract: Successfully fetched BTC to USD rate: 64710.55
2024-06-21 08:26:35,942 [INFO] data_pipeline: Data transformation complete.
2024-06-21 08:26:35,953 [INFO] data_pipeline:  872 rows & 15 columns.
2024-06-21 08:26:35,953 [INFO] data_pipeline: Loading data into data warehouse
2024-06-21 08:26:35,953 [INFO] etl_process.load: Starting to write DataFrame to MotherDuck
2024-06-21 08:27:28,823 [ERROR] etl_process.load: Error writing to MotherDuck: Invalid Input Error: Initialization function "motherduck_init" from file "/home/nerd/.duckdb/extensions/v0.10.2/linux_amd64_gcc4/motherduck.duckdb_extension" threw an exception: "Initialization function "motherduck_init" from file "/home/nerd/.duckdb/extensions/v0.10.2/linux_amd64_gcc4/motherduck.v0.10.2-2024-05-342.duckdb_extension" threw an exception: "Request failed: DNS resolution failed for api.motherduck.com:443: C-ares status is not ARES_SUCCESS qtype=A name=api.motherduck.com is_balancer=0: Timeout while contacting DNS servers (UNAVAILABLE, RPC 'GET_WELCOME_PACK', request id: '819039b0-ce12-4b4a-b3f4-52ea267a9618')""
2024-06-21 08:27:28,823 [INFO] data_pipeline: Data successfully loaded into MotherDuck
2024-06-21 08:27:28,823 [INFO] data_pipeline: Pipeline completed successfully at 2024-06-21 08:27:28.823542.Total time: 0:01:11.384765
2024-06-21 08:30:19,538 [INFO] numexpr.utils: NumExpr defaulting to 4 threads.
2024-06-21 08:30:20,090 [INFO] data_pipeline: Pipeline started at 2024-06-21 08:30:20.090929
2024-06-21 08:30:20,091 [INFO] data_pipeline: Fetching exchange data from CoinGecko API
2024-06-21 08:30:20,091 [INFO] etl_process.extract: Starting to fetch data from https://api.coingecko.com/api/v3/exchanges with headers: {'accept': 'application/json', 'x-cg-pro-api-key': None}
2024-06-21 08:30:20,103 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:30:22,217 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=1 HTTP/1.1" 200 None
2024-06-21 08:30:22,471 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=1 returned status: 200
2024-06-21 08:30:22,472 [INFO] etl_process.extract: Fetched 100 records from page 1
2024-06-21 08:30:22,473 [INFO] etl_process.extract: Proceeding to the next page: 2
2024-06-21 08:30:23,476 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:30:24,467 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=2 HTTP/1.1" 200 None
2024-06-21 08:30:24,508 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=2 returned status: 200
2024-06-21 08:30:24,511 [INFO] etl_process.extract: Fetched 100 records from page 2
2024-06-21 08:30:24,511 [INFO] etl_process.extract: Proceeding to the next page: 3
2024-06-21 08:30:25,516 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:30:26,506 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=3 HTTP/1.1" 200 None
2024-06-21 08:30:26,514 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=3 returned status: 200
2024-06-21 08:30:26,515 [INFO] etl_process.extract: Fetched 100 records from page 3
2024-06-21 08:30:26,516 [INFO] etl_process.extract: Proceeding to the next page: 4
2024-06-21 08:30:27,517 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:30:28,208 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=4 HTTP/1.1" 200 None
2024-06-21 08:30:28,213 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=4 returned status: 200
2024-06-21 08:30:28,216 [INFO] etl_process.extract: Fetched 100 records from page 4
2024-06-21 08:30:28,216 [INFO] etl_process.extract: Proceeding to the next page: 5
2024-06-21 08:30:29,218 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:30:29,852 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=5 HTTP/1.1" 200 None
2024-06-21 08:30:29,856 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=5 returned status: 200
2024-06-21 08:30:29,859 [INFO] etl_process.extract: Fetched 100 records from page 5
2024-06-21 08:30:29,859 [INFO] etl_process.extract: Proceeding to the next page: 6
2024-06-21 08:30:30,862 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:30:31,546 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=6 HTTP/1.1" 200 None
2024-06-21 08:30:31,552 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=6 returned status: 200
2024-06-21 08:30:31,556 [INFO] etl_process.extract: Fetched 100 records from page 6
2024-06-21 08:30:31,558 [INFO] etl_process.extract: Proceeding to the next page: 7
2024-06-21 08:30:32,562 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:30:33,301 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=7 HTTP/1.1" 200 None
2024-06-21 08:30:33,323 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=7 returned status: 200
2024-06-21 08:30:33,326 [INFO] etl_process.extract: Fetched 100 records from page 7
2024-06-21 08:30:33,326 [INFO] etl_process.extract: Proceeding to the next page: 8
2024-06-21 08:30:34,329 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:30:35,056 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=8 HTTP/1.1" 200 None
2024-06-21 08:30:35,092 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=8 returned status: 200
2024-06-21 08:30:35,094 [INFO] etl_process.extract: Fetched 100 records from page 8
2024-06-21 08:30:35,094 [INFO] etl_process.extract: Proceeding to the next page: 9
2024-06-21 08:30:36,096 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:30:36,771 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=9 HTTP/1.1" 200 None
2024-06-21 08:30:36,782 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=9 returned status: 200
2024-06-21 08:30:36,784 [INFO] etl_process.extract: Fetched 72 records from page 9
2024-06-21 08:30:36,784 [INFO] etl_process.extract: No more data to fetch. Exiting loop.
2024-06-21 08:30:36,786 [INFO] data_pipeline: Fetched exchange data: 872 records
2024-06-21 08:30:36,788 [INFO] data_pipeline: Transforming exchange data
2024-06-21 08:30:36,788 [INFO] etl_process.transform: Data fetched successfully from API.
2024-06-21 08:30:36,799 [INFO] data_pipeline: Transformed complete, table: 872 rows
2024-06-21 08:30:36,799 [INFO] data_pipeline: Converting BTC to USD and performing additional transformations
2024-06-21 08:30:36,800 [INFO] etl_process.extract: Fetching BTC to USD rate from CoinCap API
2024-06-21 08:30:36,801 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coincap.io:443
2024-06-21 08:30:37,407 [DEBUG] urllib3.connectionpool: https://api.coincap.io:443 "GET /v2/rates/bitcoin HTTP/1.1" 200 None
2024-06-21 08:30:37,408 [INFO] etl_process.extract: Successfully fetched BTC to USD rate: 64745.05
2024-06-21 08:30:37,424 [INFO] data_pipeline: Data transformation complete.
2024-06-21 08:30:37,424 [INFO] data_pipeline:  872 rows & 15 columns.
2024-06-21 08:30:37,425 [INFO] data_pipeline: Loading data into data warehouse
2024-06-21 08:30:37,425 [INFO] etl_process.load: Starting to write DataFrame to MotherDuck
2024-06-21 08:31:11,329 [ERROR] etl_process.load: Error writing to MotherDuck: Invalid Input Error: Initialization function "motherduck_init" from file "/home/nerd/.duckdb/extensions/v0.10.2/linux_amd64_gcc4/motherduck.duckdb_extension" threw an exception: "Initialization function "motherduck_init" from file "/home/nerd/.duckdb/extensions/v0.10.2/linux_amd64_gcc4/motherduck.v0.10.2-2024-05-342.duckdb_extension" threw an exception: "Request failed: Jwt is not in the form of Header.Payload.Signature with two dots and 3 sections (UNAUTHENTICATED, RPC 'GET_WELCOME_PACK', request id: '819039b4-60fe-4735-ae4e-124b5111f784')""
2024-06-21 08:31:11,330 [INFO] data_pipeline: Data successfully loaded into MotherDuck
2024-06-21 08:31:11,330 [INFO] data_pipeline: Pipeline completed successfully at 2024-06-21 08:31:11.330804.Total time: 0:00:51.239875
2024-06-21 08:34:20,700 [INFO] numexpr.utils: NumExpr defaulting to 4 threads.
2024-06-21 08:34:21,546 [INFO] data_pipeline: Pipeline started at 2024-06-21 08:34:21.545994
2024-06-21 08:34:21,547 [INFO] data_pipeline: Fetching exchange data from CoinGecko API
2024-06-21 08:34:21,552 [INFO] etl_process.extract: Starting to fetch data from https://api.coingecko.com/api/v3/exchanges with headers: {'accept': 'application/json', 'x-cg-pro-api-key': None}
2024-06-21 08:34:21,557 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:34:22,214 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=1 HTTP/1.1" 200 None
2024-06-21 08:34:22,217 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=1 returned status: 200
2024-06-21 08:34:22,218 [INFO] etl_process.extract: Fetched 100 records from page 1
2024-06-21 08:34:22,219 [INFO] etl_process.extract: Proceeding to the next page: 2
2024-06-21 08:34:23,223 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:34:23,989 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=2 HTTP/1.1" 200 None
2024-06-21 08:34:23,996 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=2 returned status: 200
2024-06-21 08:34:23,998 [INFO] etl_process.extract: Fetched 100 records from page 2
2024-06-21 08:34:23,998 [INFO] etl_process.extract: Proceeding to the next page: 3
2024-06-21 08:34:25,000 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:34:25,611 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=3 HTTP/1.1" 200 None
2024-06-21 08:34:25,614 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=3 returned status: 200
2024-06-21 08:34:25,617 [INFO] etl_process.extract: Fetched 100 records from page 3
2024-06-21 08:34:25,617 [INFO] etl_process.extract: Proceeding to the next page: 4
2024-06-21 08:34:26,620 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:34:27,448 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=4 HTTP/1.1" 200 None
2024-06-21 08:34:27,452 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=4 returned status: 200
2024-06-21 08:34:27,454 [INFO] etl_process.extract: Fetched 100 records from page 4
2024-06-21 08:34:27,455 [INFO] etl_process.extract: Proceeding to the next page: 5
2024-06-21 08:34:28,457 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:34:29,332 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=5 HTTP/1.1" 200 None
2024-06-21 08:34:29,336 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=5 returned status: 200
2024-06-21 08:34:29,340 [INFO] etl_process.extract: Fetched 100 records from page 5
2024-06-21 08:34:29,340 [INFO] etl_process.extract: Proceeding to the next page: 6
2024-06-21 08:34:30,343 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:34:31,071 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=6 HTTP/1.1" 200 None
2024-06-21 08:34:31,107 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=6 returned status: 200
2024-06-21 08:34:31,109 [INFO] etl_process.extract: Fetched 100 records from page 6
2024-06-21 08:34:31,110 [INFO] etl_process.extract: Proceeding to the next page: 7
2024-06-21 08:34:32,112 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:34:32,744 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=7 HTTP/1.1" 200 None
2024-06-21 08:34:32,747 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=7 returned status: 200
2024-06-21 08:34:32,748 [INFO] etl_process.extract: Fetched 100 records from page 7
2024-06-21 08:34:32,748 [INFO] etl_process.extract: Proceeding to the next page: 8
2024-06-21 08:34:33,751 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:34:34,339 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=8 HTTP/1.1" 200 None
2024-06-21 08:34:34,341 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=8 returned status: 200
2024-06-21 08:34:34,343 [INFO] etl_process.extract: Fetched 100 records from page 8
2024-06-21 08:34:34,344 [INFO] etl_process.extract: Proceeding to the next page: 9
2024-06-21 08:34:35,346 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:34:36,069 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=9 HTTP/1.1" 200 None
2024-06-21 08:34:36,073 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=9 returned status: 200
2024-06-21 08:34:36,075 [INFO] etl_process.extract: Fetched 72 records from page 9
2024-06-21 08:34:36,075 [INFO] etl_process.extract: No more data to fetch. Exiting loop.
2024-06-21 08:34:36,080 [INFO] data_pipeline: Fetched exchange data: 872 records
2024-06-21 08:34:36,081 [INFO] data_pipeline: Transforming exchange data
2024-06-21 08:34:36,082 [INFO] etl_process.transform: Data fetched successfully from API.
2024-06-21 08:34:36,087 [INFO] data_pipeline: Transformed complete, table: 872 rows
2024-06-21 08:34:36,088 [INFO] data_pipeline: Converting BTC to USD and performing additional transformations
2024-06-21 08:34:36,088 [INFO] etl_process.extract: Fetching BTC to USD rate from CoinCap API
2024-06-21 08:34:36,090 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coincap.io:443
2024-06-21 08:34:36,712 [DEBUG] urllib3.connectionpool: https://api.coincap.io:443 "GET /v2/rates/bitcoin HTTP/1.1" 200 None
2024-06-21 08:34:36,715 [INFO] etl_process.extract: Successfully fetched BTC to USD rate: 64713.15
2024-06-21 08:34:36,737 [INFO] data_pipeline: Data transformation complete.
2024-06-21 08:34:36,737 [INFO] data_pipeline:  872 rows & 15 columns.
2024-06-21 08:34:36,737 [INFO] data_pipeline: Loading data into data warehouse
2024-06-21 08:34:36,737 [INFO] etl_process.load: Starting to write DataFrame to MotherDuck
2024-06-21 08:35:27,229 [ERROR] etl_process.load: Error writing to MotherDuck: Invalid Input Error: Initialization function "motherduck_init" from file "/home/nerd/.duckdb/extensions/v0.10.2/linux_amd64_gcc4/motherduck.duckdb_extension" threw an exception: "Initialization function "motherduck_init" from file "/home/nerd/.duckdb/extensions/v0.10.2/linux_amd64_gcc4/motherduck.v0.10.2-2024-05-342.duckdb_extension" threw an exception: "Request failed: DNS resolution failed for api.motherduck.com:443: C-ares status is not ARES_SUCCESS qtype=A name=api.motherduck.com is_balancer=0: Timeout while contacting DNS servers (UNAVAILABLE, RPC 'GET_WELCOME_PACK', request id: '819039b8-1ae9-4be5-ba14-06b3f3b7020a')""
2024-06-21 08:35:27,229 [INFO] data_pipeline: Data successfully loaded into MotherDuck
2024-06-21 08:35:27,230 [INFO] data_pipeline: Pipeline completed successfully at 2024-06-21 08:35:27.230050.Total time: 0:01:05.684056
2024-06-21 08:36:31,179 [INFO] numexpr.utils: NumExpr defaulting to 4 threads.
2024-06-21 08:36:31,638 [INFO] data_pipeline: Pipeline started at 2024-06-21 08:36:31.638375
2024-06-21 08:36:31,638 [INFO] data_pipeline: Fetching exchange data from CoinGecko API
2024-06-21 08:36:31,638 [INFO] etl_process.extract: Starting to fetch data from https://api.coingecko.com/api/v3/exchanges with headers: {'accept': 'application/json', 'x-cg-pro-api-key': None}
2024-06-21 08:36:31,647 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:36:32,282 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=1 HTTP/1.1" 200 None
2024-06-21 08:36:32,285 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=1 returned status: 200
2024-06-21 08:36:32,286 [INFO] etl_process.extract: Fetched 100 records from page 1
2024-06-21 08:36:32,286 [INFO] etl_process.extract: Proceeding to the next page: 2
2024-06-21 08:36:33,289 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:36:34,154 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=2 HTTP/1.1" 200 None
2024-06-21 08:36:34,161 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=2 returned status: 200
2024-06-21 08:36:34,165 [INFO] etl_process.extract: Fetched 100 records from page 2
2024-06-21 08:36:34,165 [INFO] etl_process.extract: Proceeding to the next page: 3
2024-06-21 08:36:35,167 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:36:35,918 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=3 HTTP/1.1" 200 None
2024-06-21 08:36:35,923 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=3 returned status: 200
2024-06-21 08:36:35,925 [INFO] etl_process.extract: Fetched 100 records from page 3
2024-06-21 08:36:35,925 [INFO] etl_process.extract: Proceeding to the next page: 4
2024-06-21 08:36:36,928 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:36:37,571 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=4 HTTP/1.1" 200 None
2024-06-21 08:36:37,576 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=4 returned status: 200
2024-06-21 08:36:37,579 [INFO] etl_process.extract: Fetched 100 records from page 4
2024-06-21 08:36:37,581 [INFO] etl_process.extract: Proceeding to the next page: 5
2024-06-21 08:36:38,585 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:36:39,213 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=5 HTTP/1.1" 200 None
2024-06-21 08:36:39,218 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=5 returned status: 200
2024-06-21 08:36:39,220 [INFO] etl_process.extract: Fetched 100 records from page 5
2024-06-21 08:36:39,220 [INFO] etl_process.extract: Proceeding to the next page: 6
2024-06-21 08:36:40,221 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:36:41,107 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=6 HTTP/1.1" 200 None
2024-06-21 08:36:41,111 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=6 returned status: 200
2024-06-21 08:36:41,113 [INFO] etl_process.extract: Fetched 100 records from page 6
2024-06-21 08:36:41,113 [INFO] etl_process.extract: Proceeding to the next page: 7
2024-06-21 08:36:42,114 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:36:42,554 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=7 HTTP/1.1" 429 187
2024-06-21 08:36:42,559 [WARNING] etl_process.extract: Rate limit exceeded. Retrying after a delay...
2024-06-21 08:37:42,562 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:37:43,234 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=7 HTTP/1.1" 200 None
2024-06-21 08:37:43,253 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=7 returned status: 200
2024-06-21 08:37:43,256 [INFO] etl_process.extract: Fetched 100 records from page 7
2024-06-21 08:37:43,256 [INFO] etl_process.extract: Proceeding to the next page: 8
2024-06-21 08:37:44,259 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:37:45,221 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=8 HTTP/1.1" 200 None
2024-06-21 08:37:45,228 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=8 returned status: 200
2024-06-21 08:37:45,231 [INFO] etl_process.extract: Fetched 100 records from page 8
2024-06-21 08:37:45,231 [INFO] etl_process.extract: Proceeding to the next page: 9
2024-06-21 08:37:46,233 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:37:46,904 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=9 HTTP/1.1" 200 None
2024-06-21 08:37:46,922 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=9 returned status: 200
2024-06-21 08:37:46,927 [INFO] etl_process.extract: Fetched 72 records from page 9
2024-06-21 08:37:46,928 [INFO] etl_process.extract: No more data to fetch. Exiting loop.
2024-06-21 08:37:46,930 [INFO] data_pipeline: Fetched exchange data: 872 records
2024-06-21 08:37:46,931 [INFO] data_pipeline: Transforming exchange data
2024-06-21 08:37:46,931 [INFO] etl_process.transform: Data fetched successfully from API.
2024-06-21 08:37:46,944 [INFO] data_pipeline: Transformed complete, table: 872 rows
2024-06-21 08:37:46,945 [INFO] data_pipeline: Converting BTC to USD and performing additional transformations
2024-06-21 08:37:46,945 [INFO] etl_process.extract: Fetching BTC to USD rate from CoinCap API
2024-06-21 08:37:46,947 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coincap.io:443
2024-06-21 08:37:47,719 [DEBUG] urllib3.connectionpool: https://api.coincap.io:443 "GET /v2/rates/bitcoin HTTP/1.1" 200 None
2024-06-21 08:37:47,720 [INFO] etl_process.extract: Successfully fetched BTC to USD rate: 64691.57
2024-06-21 08:37:47,743 [INFO] data_pipeline: Data transformation complete.
2024-06-21 08:37:47,743 [INFO] data_pipeline:  872 rows & 15 columns.
2024-06-21 08:37:47,744 [INFO] data_pipeline: Loading data into data warehouse
2024-06-21 08:37:47,744 [INFO] etl_process.load: Starting to write DataFrame to MotherDuck
2024-06-21 08:38:21,350 [ERROR] etl_process.load: Error writing to MotherDuck: Invalid Input Error: Initialization function "motherduck_init" from file "/home/nerd/.duckdb/extensions/v0.10.2/linux_amd64_gcc4/motherduck.duckdb_extension" threw an exception: "Initialization function "motherduck_init" from file "/home/nerd/.duckdb/extensions/v0.10.2/linux_amd64_gcc4/motherduck.v0.10.2-2024-05-342.duckdb_extension" threw an exception: "Request failed: Jwt is not in the form of Header.Payload.Signature with two dots and 3 sections (UNAUTHENTICATED, RPC 'GET_WELCOME_PACK', request id: '819039ba-f085-4100-b4b2-76becaeffdc8')""
2024-06-21 08:38:21,351 [INFO] data_pipeline: Data successfully loaded into MotherDuck
2024-06-21 08:38:21,351 [INFO] data_pipeline: Pipeline completed successfully at 2024-06-21 08:38:21.351349.Total time: 0:01:49.712974
2024-06-21 08:56:24,770 [INFO] numexpr.utils: NumExpr defaulting to 4 threads.
2024-06-21 08:56:25,351 [INFO] data_pipeline: Pipeline started at 2024-06-21 08:56:25.351839
2024-06-21 08:56:25,352 [INFO] data_pipeline: Fetching exchange data from CoinGecko API
2024-06-21 08:56:25,352 [INFO] etl_process.extract: Starting to fetch data from https://api.coingecko.com/api/v3/exchanges with headers: {'accept': 'application/json', 'x-cg-pro-api-key': None}
2024-06-21 08:56:25,356 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:56:26,317 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=1 HTTP/1.1" 200 None
2024-06-21 08:56:26,326 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=1 returned status: 200
2024-06-21 08:56:26,327 [INFO] etl_process.extract: Fetched 100 records from page 1
2024-06-21 08:56:26,327 [INFO] etl_process.extract: Proceeding to the next page: 2
2024-06-21 08:56:27,330 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:56:28,060 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=2 HTTP/1.1" 200 None
2024-06-21 08:56:28,070 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=2 returned status: 200
2024-06-21 08:56:28,072 [INFO] etl_process.extract: Fetched 100 records from page 2
2024-06-21 08:56:28,072 [INFO] etl_process.extract: Proceeding to the next page: 3
2024-06-21 08:56:29,074 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:56:29,820 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=3 HTTP/1.1" 200 None
2024-06-21 08:56:29,824 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=3 returned status: 200
2024-06-21 08:56:29,825 [INFO] etl_process.extract: Fetched 100 records from page 3
2024-06-21 08:56:29,826 [INFO] etl_process.extract: Proceeding to the next page: 4
2024-06-21 08:56:30,828 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:56:31,751 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=4 HTTP/1.1" 200 None
2024-06-21 08:56:31,753 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=4 returned status: 200
2024-06-21 08:56:31,755 [INFO] etl_process.extract: Fetched 100 records from page 4
2024-06-21 08:56:31,755 [INFO] etl_process.extract: Proceeding to the next page: 5
2024-06-21 08:56:32,757 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:56:33,368 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=5 HTTP/1.1" 200 None
2024-06-21 08:56:33,374 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=5 returned status: 200
2024-06-21 08:56:33,377 [INFO] etl_process.extract: Fetched 100 records from page 5
2024-06-21 08:56:33,382 [INFO] etl_process.extract: Proceeding to the next page: 6
2024-06-21 08:56:34,385 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:56:35,055 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=6 HTTP/1.1" 200 None
2024-06-21 08:56:35,061 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=6 returned status: 200
2024-06-21 08:56:35,063 [INFO] etl_process.extract: Fetched 100 records from page 6
2024-06-21 08:56:35,063 [INFO] etl_process.extract: Proceeding to the next page: 7
2024-06-21 08:56:36,066 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:56:37,076 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=7 HTTP/1.1" 200 None
2024-06-21 08:56:37,080 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=7 returned status: 200
2024-06-21 08:56:37,083 [INFO] etl_process.extract: Fetched 100 records from page 7
2024-06-21 08:56:37,083 [INFO] etl_process.extract: Proceeding to the next page: 8
2024-06-21 08:56:38,085 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:56:38,689 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=8 HTTP/1.1" 200 None
2024-06-21 08:56:38,694 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=8 returned status: 200
2024-06-21 08:56:38,697 [INFO] etl_process.extract: Fetched 100 records from page 8
2024-06-21 08:56:38,697 [INFO] etl_process.extract: Proceeding to the next page: 9
2024-06-21 08:56:39,698 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coingecko.com:443
2024-06-21 08:56:40,316 [DEBUG] urllib3.connectionpool: https://api.coingecko.com:443 "GET /api/v3/exchanges?per_page=100&page=9 HTTP/1.1" 200 None
2024-06-21 08:56:40,320 [INFO] etl_process.extract: API request to https://api.coingecko.com/api/v3/exchanges?per_page=100&page=9 returned status: 200
2024-06-21 08:56:40,322 [INFO] etl_process.extract: Fetched 73 records from page 9
2024-06-21 08:56:40,322 [INFO] etl_process.extract: No more data to fetch. Exiting loop.
2024-06-21 08:56:40,324 [INFO] data_pipeline: Fetched exchange data: 873 records
2024-06-21 08:56:40,326 [INFO] data_pipeline: Transforming exchange data
2024-06-21 08:56:40,326 [INFO] etl_process.transform: Data fetched successfully from API.
2024-06-21 08:56:40,344 [INFO] data_pipeline: Transformed complete, table: 873 rows
2024-06-21 08:56:40,346 [INFO] data_pipeline: Converting BTC to USD and performing additional transformations
2024-06-21 08:56:40,346 [INFO] etl_process.extract: Fetching BTC to USD rate from CoinCap API
2024-06-21 08:56:40,349 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.coincap.io:443
2024-06-21 08:56:41,535 [DEBUG] urllib3.connectionpool: https://api.coincap.io:443 "GET /v2/rates/bitcoin HTTP/1.1" 200 None
2024-06-21 08:56:41,536 [INFO] etl_process.extract: Successfully fetched BTC to USD rate: 64415.41
2024-06-21 08:56:41,560 [INFO] data_pipeline: Data transformation complete.
2024-06-21 08:56:41,560 [INFO] data_pipeline:  873 rows & 15 columns.
2024-06-21 08:56:41,560 [INFO] data_pipeline: Loading data into data warehouse
2024-06-21 08:56:41,560 [INFO] etl_process.load: Starting to write DataFrame to MotherDuck
2024-06-21 08:57:26,719 [ERROR] etl_process.load: Error writing to MotherDuck: Invalid Input Error: Initialization function "motherduck_init" from file "/home/nerd/.duckdb/extensions/v0.10.2/linux_amd64_gcc4/motherduck.duckdb_extension" threw an exception: "Initialization function "motherduck_init" from file "/home/nerd/.duckdb/extensions/v0.10.2/linux_amd64_gcc4/motherduck.v0.10.2-2024-05-342.duckdb_extension" threw an exception: "Request failed: Jwt is not in the form of Header.Payload.Signature with two dots and 3 sections (UNAUTHENTICATED, RPC 'GET_WELCOME_PACK', request id: '819039cc-5454-42d1-b4f3-44117b954252')""
2024-06-21 08:57:26,719 [INFO] data_pipeline: Data successfully loaded into MotherDuck
2024-06-21 08:57:26,719 [INFO] data_pipeline: Pipeline completed successfully at 2024-06-21 08:57:26.719671.Total time: 0:01:01.367832
2024-06-21 09:32:02,292 [INFO] numexpr.utils: NumExpr defaulting to 4 threads.
2024-06-21 09:32:03,155 [INFO] data_pipeline: Pipeline started at 2024-06-21 09:32:03.155006
2024-06-21 09:32:03,155 [INFO] data_pipeline: Fetching exchange data from CoinGecko API
2024-06-21 09:32:03,155 [INFO] data_pipeline: Fetched exchange data: 1 records
2024-06-21 09:32:03,155 [INFO] data_pipeline: Transforming exchange data
2024-06-21 09:32:03,155 [INFO] etl_process.transform: Data fetched successfully from API.
2024-06-21 09:32:03,155 [ERROR] data_pipeline: Error running pipeline: 'trade_volume_24h_btc'
2024-06-21 09:33:23,595 [INFO] numexpr.utils: NumExpr defaulting to 4 threads.
2024-06-21 09:33:24,128 [INFO] data_pipeline: Pipeline started at 2024-06-21 09:33:24.128117
2024-06-21 09:33:24,128 [INFO] data_pipeline: Fetching exchange data from CoinGecko API
2024-06-21 09:33:24,128 [INFO] data_pipeline: Fetched exchange data: 1 records
2024-06-21 09:33:24,128 [INFO] data_pipeline: Transforming exchange data
2024-06-21 09:33:24,129 [INFO] data_pipeline: Transformed complete, table: 1 rows
2024-06-21 09:33:24,129 [INFO] data_pipeline: Converting BTC to USD and performing additional transformations
2024-06-21 09:33:24,129 [INFO] data_pipeline: Data transformation complete.
2024-06-21 09:33:24,129 [INFO] data_pipeline:  1 rows & 15 columns.
2024-06-21 09:33:24,129 [INFO] data_pipeline: Loading data into data warehouse
2024-06-21 09:33:24,130 [INFO] data_pipeline: Data successfully loaded into MotherDuck
2024-06-21 09:33:24,130 [INFO] data_pipeline: Pipeline completed successfully at 2024-06-21 09:33:24.130408.Total time: 0:00:00.002291
2024-06-21 09:33:38,573 [INFO] numexpr.utils: NumExpr defaulting to 4 threads.
2024-06-21 09:33:38,975 [INFO] data_pipeline: Pipeline started at 2024-06-21 09:33:38.975093
2024-06-21 09:33:38,975 [INFO] data_pipeline: Fetching exchange data from CoinGecko API
2024-06-21 09:33:38,975 [INFO] data_pipeline: Fetched exchange data: 1 records
2024-06-21 09:33:38,975 [INFO] data_pipeline: Transforming exchange data
2024-06-21 09:33:38,975 [INFO] data_pipeline: Transformed complete, table: 1 rows
2024-06-21 09:33:38,976 [INFO] data_pipeline: Converting BTC to USD and performing additional transformations
2024-06-21 09:33:38,976 [INFO] data_pipeline: Data transformation complete.
2024-06-21 09:33:38,976 [INFO] data_pipeline:  1 rows & 15 columns.
2024-06-21 09:33:38,976 [INFO] data_pipeline: Loading data into data warehouse
2024-06-21 09:33:38,977 [INFO] data_pipeline: Data successfully loaded into MotherDuck
2024-06-21 09:33:38,977 [INFO] data_pipeline: Pipeline completed successfully at 2024-06-21 09:33:38.977274.Total time: 0:00:00.002181
2024-06-21 09:35:29,492 [INFO] numexpr.utils: NumExpr defaulting to 4 threads.
2024-06-21 09:35:30,034 [INFO] data_pipeline: Pipeline started at 2024-06-21 09:35:30.034180
2024-06-21 09:35:30,034 [INFO] data_pipeline: Fetching exchange data from CoinGecko API
2024-06-21 09:35:30,034 [INFO] data_pipeline: Fetched exchange data: 4 records
2024-06-21 09:35:30,035 [INFO] data_pipeline: Transforming exchange data
2024-06-21 09:35:30,035 [INFO] data_pipeline: Transformed complete, table: 1 rows
2024-06-21 09:35:30,035 [INFO] data_pipeline: Converting BTC to USD and performing additional transformations
2024-06-21 09:35:30,035 [INFO] data_pipeline: Data transformation complete.
2024-06-21 09:35:30,035 [INFO] data_pipeline:  1 rows & 15 columns.
2024-06-21 09:35:30,035 [INFO] data_pipeline: Loading data into data warehouse
2024-06-21 09:35:30,036 [INFO] data_pipeline: Data successfully loaded into MotherDuck
2024-06-21 09:35:30,036 [INFO] data_pipeline: Pipeline completed successfully at 2024-06-21 09:35:30.036848.Total time: 0:00:00.002668
